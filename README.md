# Cloud camp test assignment

## 1. –í–æ–ø—Ä–æ—Å—ã –¥–ª—è —Ä–∞–∑–æ–≥—Ä–µ–≤–∞

### –û–ø–∏—à–∏—Ç–µ —Å–∞–º—É—é –∏–Ω—Ç–µ—Ä–µ—Å–Ω—É—é –∑–∞–¥–∞—á—É –≤ –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏–∏, –∫–æ—Ç–æ—Ä—É—é –≤–∞–º –ø—Ä–∏—Ö–æ–¥–∏–ª–æ—Å—å —Ä–µ—à–∞—Ç—å?

–ù–µ —Å–∞–º–∞—è –∞–∫—Ç—É–∞–ª—å–Ω–∞—è, –Ω–æ –æ—á–µ–Ω—å –∏–Ω—Ç–µ—Ä–µ—Å–Ω–∞—è, –∫–æ—Ç–æ—Ä—É—é –ø–æ–º–Ω—é –¥–æ —Å–∏—Ö –ø–æ—Ä.

–ì–æ–¥—É –≤ 2019-2020 (—Ç–æ—á–Ω–æ –Ω–µ –ø–æ–º–Ω—é, –º–æ–≥—É –±—ã—Ç—å —É–≤–µ—Ä–µ–Ω —Ç–æ–ª—å–∫–æ –≤ —Ç–æ–º, —á—Ç–æ –Ω–µ–π—Ä–æ—Å–µ—Ç–µ–π —Ç–æ–≥–¥–∞ –∏ –Ω–µ –±—ã–ª–æ –∏ –≤ –ø–æ–º–∏–Ω–µ),
–∫–æ–≥–¥–∞ —è –µ—â—ë —É—á–∏–ª—Å—è –≤ —à–∫–æ–ª–µ, –æ–¥–∏–Ω –ø—Ä–µ–ø–æ–¥–∞–≤–∞—Ç–µ–ª—å –ø—Ä–µ–¥–ª–æ–∂–∏–ª –∏–¥–µ—é –¥–ª—è –ø—Ä–æ–µ–∫—Ç–∞: 
–ø—Ä–æ–≥—Ä–∞–º–º–∞ –¥–ª—è —Ä–∞—Å—Å–∞–¥–∫–∏ —É—á–µ–Ω–∏–∫–æ–≤ –≤ –∫–ª–∞—Å—Å–µ. –£—á–∏—Ç—ã–≤–∞–µ—Ç—Å—è —Ä–æ—Å—Ç, –∑—Ä–µ–Ω–∏–µ –∏ —Ç–µ–º–ø–µ—Ä–∞–º–µ–Ω—Ç—ã —É—á–µ–Ω–∏–∫–æ–≤ (—Å–æ–≥–ª–∞—Å–Ω–æ –∫–∞–∫–æ–π-—Ç–æ —Ç–∞–º
–ø–µ–¥–∞–≥–æ–≥–∏—á–µ—Å–∫–∏-–ø—Å–∏—Ö–æ–ª–æ–≥–∏—á–µ—Å–∫–æ–π —Ä–∞–±–æ—Ç–µ, –Ω–µ–∫–æ—Ç–æ—Ä—ã–º–∏ —Ç–µ–º–ø–µ—Ä–∞–º–µ–Ω—Ç–∞–º –Ω–µ–ª—å–∑—è —Å–∏–¥–µ—Ç—å –∑–∞ –æ–¥–Ω–æ–π –ø–∞—Ä—Ç–æ–π –¥—Ä—É–≥ —Å –¥—Ä—É–≥–æ–º (–≤ –∫–æ–Ω–µ—á–Ω–æ–º 
—Å—á—ë—Ç–µ –±—ã–ª–æ —Ç–æ–ª—å–∫–æ –æ–¥–Ω–æ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –≤ –≤–∏–¥–µ –ø–∞—Ä—ã "—Ö–æ–ª–µ—Ä–∏–∫"-"–º–µ–ª–∞–Ω—Ö–æ–ª–∏–∫")). –Ø –æ—á–µ–Ω—å –¥–æ–ª–≥–æ –ø—ã—Ç–∞–ª—Å—è –¥–æ–±–∏—Ç—å—Å—è –∂–µ–ª–∞–µ–º–æ–≥–æ 
—Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞ —Ä–∞–±–æ—Ç—ã –ø—Ä–æ–≥—Ä–∞–º–º—ã –∏ –Ω–∞–∫–æ–Ω–µ—Ü-—Ç–æ –ø–æ–ª—É—á–∏–ª –µ–≥–æ. –ó–∞–¥–∞—á–∞ –±—ã–ª–∞ –æ—á–µ–Ω—å –∏–Ω—Ç–µ—Ä–µ—Å–Ω–æ–π, –≤ —Ç–æ–º —á–∏—Å–ª–µ –ø–æ—Ç–æ–º—É, 
—á—Ç–æ –¥–ª—è –º–µ–Ω—è —ç—Ç–æ –±—ã–ª –ø–µ—Ä–≤—ã–π –æ–ø—ã—Ç –Ω–∞–ø–∏—Å–∞–Ω–∏—è –Ω–µ–∞–∫–∞–¥–µ–º–∏—á–µ—Å–∫–æ–≥–æ –∫–æ–¥–∞.  

### –†–∞—Å—Å–∫–∞–∂–∏—Ç–µ –æ —Å–≤–æ–µ–º —Å–∞–º–æ–º –±–æ–ª—å—à–æ–º —Ñ–∞–∫–∞–ø–µ? –ß—Ç–æ –≤—ã –ø—Ä–µ–¥–ø—Ä–∏–Ω—è–ª–∏ –¥–ª—è —Ä–µ—à–µ–Ω–∏—è –ø—Ä–æ–±–ª–µ–º—ã?

–ó–∞–±—ã–ª –¥–æ–±–∞–≤–∏—Ç—å —Ñ–∞–π–ª `.env` –≤ `.gitignore` ü§ì

–ù–∞ —Ç–æ—Ç –º–æ–º–µ–Ω—Ç, –µ–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω—ã–º —Ä–µ—à–µ–Ω–∏–µ–º –±—ã–ª–æ –ø–µ—Ä–µ—Å–æ–∑–¥–∞–≤–∞—Ç—å —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π, –Ω–æ –Ω–∞ —Å–ª—É—á–∞–π –ø–æ–¥–æ–±–Ω—ã—Ö –Ω–µ–ø—Ä–µ–¥–≤–∏–¥–µ–Ω–Ω—ã—Ö —Å–∏—Ç—É–∞—Ü–∏–π
—è —Ä–∞–∑–æ–±—Ä–∞–ª—Å—è –∫–∞–∫ –¥–µ–ª–∞—Ç—å –æ—Ç–∫–∞—Ç –ø–æ –∫–æ–º–º–∏—Ç–∞–º –∏ —É–¥–∞–ª—è—Ç—å –≤—Å–µ –∫–æ–º–º–∏—Ç—ã –ø–æ—Å–ª–µ —Ç–æ–≥–æ, –Ω–∞ –∫–æ—Ç–æ—Ä—ã–π –æ—Ç–∫–∞—Ç–∏–ª—Å—è (—á—Ç–æ–±—ã –≤ –ø—É–±–ª–∏—á–Ω—ã—Ö
—Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è—Ö –Ω–µ–ª—å–∑—è –±—ã–ª–æ –ø–æ–ª—É—á–∏—Ç—å —Ü–µ–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –∏ api-–∫–ª—é—á–∏ —á–µ—Ä–µ–∑ –∏—Å—Ç–æ—Ä–∏—é –∫–æ–º–º–∏—Ç–æ–≤)

### –ö–∞–∫–æ–≤—ã –≤–∞—à–∏ –æ–∂–∏–¥–∞–Ω–∏—è –æ—Ç —É—á–∞—Å—Ç–∏—è –≤ –±—É—Ç–∫–µ–º–ø–µ?

–ü–æ–ª—É—á–∏—Ç—å –æ–ø—ã—Ç –∫–æ–º–º–µ—Ä—á–µ—Å–∫–æ–π —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏, –æ–∑–Ω–∞–∫–æ–º–∏—Ç—å—Å—è
—Å —Ç–æ–Ω–∫–æ—Å—Ç—è–º–∏, –∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–º–∏ –ø—Ä–∏ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ —Ä–µ–∞–ª—å–Ω—ã—Ö —Å–∏—Å—Ç–µ–º.
–ù–∞—É—á–∏—Ç—å—Å—è —Ä–∞–±–æ—Ç–∞—Ç—å –≤ –∫–æ–º–∞–Ω–¥–µ —Å –¥—Ä—É–≥–∏–º–∏ —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–∞–º–∏,
–ø–æ–ª—É—á–∏—Ç—å –æ–ø—ã—Ç –≥—Ä–∞–º–æ—Ç–Ω–æ–≥–æ —Ä–∞–∑–¥–µ–ª–µ–Ω–∏—è –±–æ–ª—å—à–æ–π –∑–∞–¥–∞—á–∏ –Ω–∞ –ø–æ–¥–∑–∞–¥–∞—á–∏.

–ò –Ω–∞–∫–æ–Ω–µ—Ü-—Ç–æ —Ä–∞–∑–æ–±—Ä–∞—Ç—å—Å—è –≤ —Ä–∞–±–æ—Ç–µ Kubernetes, –∏ –Ω–∞—á–∞—Ç—å –ø—Ä–∏–º–µ–Ω—è—Ç—å –µ–≥–æ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ –Ω–∞ –ø—Ä–∞–∫—Ç–∏–∫–µ

## 2. –†–∞–∑—Ä–∞–±–æ—Ç–∫–∞ HTTP-–±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤—â–∏–∫–∞ –Ω–∞–≥—Ä—É–∑–∫–∏ –Ω–∞ Go
 
### –°–±–æ—Ä–∫–∞ –∏ –∑–∞–ø—É—Å–∫

```bash
go mod tidy
go build main.go
```
–ï—Å–ª–∏ —Ç—Ä–µ–±—É–µ—Ç—Å—è –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ–µ –∏–º—è —Ñ–∞–π–ª–∞:
```bash
go mod tidy
go build -o filename main.go
```

### –°–ø–∏—Å–æ–∫ –±–µ–∫–µ–Ω–¥–æ–≤

–°–ø–∏—Å–æ–∫ –±–µ–∫–µ–Ω–¥–æ–≤ —Ö—Ä–∞–Ω–∏—Ç—Å—è –≤ `servers.json`

–§–æ—Ä–º–∞—Ç `servers.json`

```json
{
  "backends": [
    "http://localhost:8081",
    "http://localhost:8082",
    "http://localhost:8083"
  ]
}
```

–£ –∫–∞–∂–¥–æ–≥–æ –±–µ–∫–µ–Ω–¥–∞ –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –º–µ—Ç–æ–¥ `/health`, –∫–æ—Ç–æ—Ä—ã–π, –ø—Ä–∏ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ –±–µ–∫–µ–Ω–¥–∞ –¥–æ–ª–∂–µ–Ω –≤–æ–∑–≤—Ä–∞—â–∞—Ç—å `http.StatusOK`, –æ–Ω –∂–µ **200**

### –ñ–∏–∑–Ω–µ—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å –±–µ–∫–µ–Ω–¥–æ–≤

–ñ–∏–∑–Ω–µ—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å –±–µ–∫–µ–Ω–¥–æ–≤ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è –∫–∞–∂–¥—ã–µ 10 —Å–µ–∫—É–Ω–¥, –æ–±—Ä–∞—â–µ–Ω–∏–µ–º –∫ –º–µ—Ç–æ–¥—É `/health`

## 3. –†–µ–∞–ª–∏–∑–∞—Ü–∏—è Rate-Limiting

### –°–±–æ—Ä–∫–∞ –∏ –∑–∞–ø—É—Å–∫

#### Docker
```bash
docker-compose -f docker-compose-rl.yml up --build
```

- –°–æ–∑–¥–∞—é—Ç—Å—è 2 –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ (–¥–ª—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –∏ –¥–ª—è –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö)
- –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –ø—Ä–æ—Å–ª—É—à–∏–≤–∞–µ—Ç –ø–æ—Ä—Ç `:8080`
- –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –ø—Ä–æ—Å–ª—É—à–∏–≤–∞–µ—Ç –ø–æ—Ä—Ç `:5432`

–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –≥–æ—Ç–æ–≤–æ –ø—Ä–∏–Ω–∏–º–∞—Ç—å –∑–∞–ø—Ä–æ—Å—ã!

–î–ª—è –æ—Å—Ç–∞–Ω–æ–≤–∫–∏:
```bash
docker-compose -f docker-compose-rl.yml down
```

#### –õ–æ–∫–∞–ª—å–Ω–æ

```bash
go mod tidy
go build main.go
```

–ï—Å–ª–∏ —Ç—Ä–µ–±—É–µ—Ç—Å—è –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ–µ –∏–º—è —Ñ–∞–π–ª–∞:
```bash
go mod tidy
go build -o filename main.go
```

–î–ª—è —Ä–∞–±–æ—Ç—ã –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è —Ç—Ä–µ–±—É–µ—Ç—Å—è **PostgreSQL** –≤–µ—Ä—Å–∏–∏ **14** –∏–ª–∏ –≤—ã—à–µ

–î–ª—è –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ —Ç–∞–±–ª–∏—Ü —Ç—Ä–µ–±—É–µ—Ç—Å—è —Å–æ–∑–¥–∞–Ω–Ω–∞—è –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö `rate-limiting`

–ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Ç–∞–±–ª–∏—Ü
```bash
psql -U username -d rate-limiting -f ./sql/01_initTables.sql
```

–î–ª—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è —Ç–µ—Å—Ç–æ–≤–æ–≥–æ API-–∫–ª—é—á–∞
```bash
psql -U username -d rate-limiting -f ./sql/01_initTestAPIKey.sql
```

–í –æ–±–æ–∏—Ö –ø—Ä–∏–º–µ—Ä–∞—Ö –∑–∞–º–µ–Ω–∏—Ç—å username –Ω–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö

### –í–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ

–î–ª—è –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è —Å —Å–µ—Ä–≤–µ—Ä–æ–º, –≤ –∑–∞–≥–æ–ª–æ–≤–∫–µ –∑–∞–ø—Ä–æ—Å–∞ –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å –ø–æ–ª–µ "X-API-KEY"

–ü—Ä–∏–º–µ—Ä –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è —á–µ—Ä–µ–∑ cURL:
```bash
% curl -H "X-API-KEY: TEST_API_KEY" localhost:8080
```

### –î–æ–ø–æ–ª–Ω–µ–Ω–∏–µ

- –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ–± –æ—Å—Ç–∞–≤—à–∏—Ö—Å—è –∑–∞–ø—Ä–æ—Å–∞—Ö –Ω–µ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è (–Ω–µ —É—Å–ø–µ–ª –Ω–∞–ø–∏—Å–∞—Ç—å –ª–æ–≥–∏–∫—É —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –æ—Å—Ç–∞–≤—à–∏—Ö—Å—è –∑–∞–ø—Ä–æ—Å–æ–≤ –≤ –ë–î)
- –ö–∞–∂–¥—ã–µ 5 –º–∏–Ω—É—Ç –Ω–µ–∞–∫—Ç–∏–≤–Ω—ã–µ API-–∫–ª—é—á–∏ –≤—ã–≥—Ä—É–∂–∞—é—Ç—Å—è –∏–∑ –ø–∞–º—è—Ç–∏
- - –¢.–µ. –∑–∞ 5 –º–∏–Ω—É—Ç –æ—Å—Ç–∞—Ç–æ–∫ –ø–æ–ª–Ω–æ—Å—Ç—å—é —Å–±—Ä–æ—Å–∏—Ç—Å—è
- –ù–∞ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ –∏ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é –Ω–µ —Ö–≤–∞—Ç–∏–ª–æ –≤—Ä–µ–º–µ–Ω–∏